import math

from .production import *
    
class NozzleProduction(Production):
    
    MX_DB = {
        100 : {
            60 : 0.38,
            70 : 0.44,
            80 : 0.5,
            90 : 0.6,
            100 : 0.7,
            120 : 0.8,
            130 : 0.9,
            145 : 1,
            160 : 1.1,
            175 : 1.2,
            190 : 1.3,
            205 : 1.4,
            220 : 1.5,
            240 : 1.6,
            260 : 1.7,
            280 : 1.8,
            300 : 1.89,
            325 : 1.97,
            350 : 2.06,
            375 : 2.15,
            410 : 2.24,
            450 : 2.33,
            500 : 2.4,
            540 : 2.5,
        },
        120 : {
            60 : 0.48,
            70 : 0.52,
            80 : 0.62,
            90 : 0.72,
            100 : 0.82,
            120 : 0.92,
            130 : 1.03,
            145 : 1.13,
            160 : 1.23,
            175 : 1.33,
            190 : 1.43,
            205 : 1.53,
            220 : 1.63,
            240 : 1.73,
            260 : 1.84,
            280 : 1.95,
            300 : 2.05,
            325 : 2.15,
            350 : 2.25,
            375 : 2.35,
            410 : 2.45,
            450 : 2.55,
            500 : 2.64,
            540 : 2.75,
        },
        140 : {
            60 : 0.59,
            70 : 0.68,
            80 : 0.77,
            90 : 0.86,
            100 : 0.95,
            120 : 1.05,
            130 : 1.15,
            145 : 1.25,
            160 : 1.35,
            175 : 1.45,
            190 : 1.55,
            205 : 1.65,
            220 : 1.75,
            240 : 1.86,
            260 : 1.98,
            280 : 2.1,
            300 : 2.21,
            325 : 2.33,
            350 : 2.44,
            375 : 2.55,
            410 : 2.66,
            450 : 2.77,
            500 : 2.88,
            540 : 3,
        },
        160 : {
            60 : 0.69,
            70 : 0.77,
            80 : 0.87,
            90 : 0.97,
            100 : 1.07,
            120 : 1.17,
            130 : 1.27,
            145 : 1.37,
            160 : 1.47,
            175 : 1.57,
            190 : 1.67,
            205 : 1.77,
            220 : 1.87,
            240 : 1.99,
            260 : 2.12,
            280 : 2.25,
            300 : 2.37,
            325 : 2.5,
            350 : 2.63,
            375 : 2.75,
            410 : 2.87,
            450 : 3,
            500 : 3.12,
            540 : 3.25,
        },
        180 : {
            60 : 0.79,
            70 : 0.89,
            80 : 0.99,
            90 : 1.09,
            100 : 1.19,
            120 : 1.29,
            130 : 1.39,
            145 : 1.49,
            160 : 1.59,
            175 : 1.69,
            190 : 1.79,
            205 : 1.89,
            220 : 1.99,
            240 : 2.12,
            260 : 2.26,
            280 : 2.4,
            300 : 2.54,
            325 : 2.68,
            350 : 2.81,
            375 : 2.95,
            410 : 3.08,
            450 : 3.22,
            500 : 3.35,
            540 : 3.49,
        },
        200 : {
            90 : 1.21,
            100 : 1.31,
            120 : 1.41,
            130 : 1.51,
            145 : 1.61,
            160 : 1.71,
            175 : 1.81,
            190 : 1.91,
            205 : 2.01,
            220 : 2.11,
            240 : 2.26,
            260 : 2.4,
            280 : 2.55,
            300 : 2.7,
            325 : 2.85,
            350 : 3,
            375 : 3.15,
            410 : 3.3,
            450 : 3.44,
            500 : 3.59,
            540 : 3.74,
        },
        220 : {
            100 : 1.44,
            120 : 1.54,
            130 : 1.64,
            145 : 1.74,
            160 : 1.84,
            175 : 1.94,
            190 : 2.04,
            205 : 2.14,
            220 : 2.24,
            240 : 2.4,
            260 : 2.55,
            280 : 2.7,
            300 : 2.87,
            325 : 3.03,
            350 : 3.18,
            375 : 3.35,
            410 : 3.51,
            450 : 3.66,
            500 : 3.83,
            540 : 3.98,
        },
        240 : {
            100 : 1.56,
            120 : 1.66,
            130 : 1.76,
            145 : 1.86,
            160 : 1.96,
            175 : 2.06,
            190 : 2.16,
            205 : 2.26,
            220 : 2.36,
            240 : 2.53,
            260 : 2.7,
            280 : 2.86,
            300 : 3.03,
            325 : 3.2,
            350 : 3.37,
            375 : 3.55,
            410 : 3.72,
            450 : 3.88,
            500 : 4.06,
            540 : 4.23,
        },
        260 : {
            120 : 1.78,
            130 : 1.88,
            145 : 1.98,
            160 : 2.08,
            175 : 2.18,
            190 : 2.28,
            205 : 2.38,
            220 : 2.48,
            240 : 2.66,
            260 : 2.84,
            280 : 3.02,
            300 : 3.2,
            325 : 3.38,
            350 : 3.56,
            375 : 3.75,
            410 : 3.93,
            450 : 4.11,
            500 : 4.29,
            540 : 4.47,
        },
        280 : {
            120 : 1.9,
            130 : 2,
            145 : 2.1,
            160 : 2.2,
            175 : 2.3,
            190 : 2.4,
            205 : 2.5,
            220 : 2.6,
            240 : 2.79,
            260 : 2.98,
            280 : 3.17,
            300 : 3.36,
            325 : 3.55,
            350 : 3.76,
            375 : 3.96,
            410 : 4.15,
            450 : 4.35,
            500 : 4.54,
            540 : 4.74,
        },
        300 : {
            130 : 2.12,
            145 : 2.22,
            160 : 2.32,
            175 : 2.42,
            190 : 2.52,
            205 : 2.62,
            220 : 2.72,
            240 : 2.92,
            260 : 3.12,
            280 : 3.32,
            300 : 3.53,
            325 : 3.73,
            350 : 3.95,
            375 : 4.17,
            410 : 4.37,
            450 : 4.58,
            500 : 4.79,
            540 : 5,
        },
        320 : {
            130 : 2.24,
            145 : 2.34,
            160 : 2.44,
            175 : 2.54,
            190 : 2.68,
            205 : 2.74,
            220 : 2.84,
            240 : 3.05,
            260 : 3.26,
            280 : 3.47,
            300 : 3.7,
            325 : 3.91,
            350 : 4.14,
            375 : 4.38,
            410 : 4.59,
            450 : 4.82,
            500 : 5.04,
            540 : 5.26,
        },
        340 : {
            145 : 2.46,
            160 : 2.56,
            175 : 2.66,
            190 : 2.76,
            205 : 2.86,
            220 : 2.96,
            240 : 3.18,
            260 : 3.4,
            280 : 3.63,
            300 : 3.86,
            325 : 4.09,
            350 : 4.33,
            375 : 4.59,
            410 : 4.81,
            450 : 5.05,
            500 : 5.29,
            540 : 5.53,
        },
        360 : {
            175 : 2.78,
            190 : 2.88,
            205 : 2.98,
            220 : 3.08,
            240 : 3.3,
            260 : 3.54,
            280 : 3.78,
            300 : 4.03,
            325 : 4.27,
            350 : 4.52,
            375 : 4.79,
            410 : 5.03,
            450 : 5.28,
            500 : 5.54,
            540 : 5.8,
        },
        380 : {
            220 : 3.16,
            240 : 3.42,
            260 : 3.68,
            280 : 3.94,
            300 : 4.2,
            325 : 4.46,
            350 : 4.72,
            375 : 4.99,
            410 : 5.25,
            450 : 5.52,
            500 : 5.8,
            540 : 6.07,
        },
        400 : {
            260 : 3.82,
            280 : 4.1,
            300 : 4.36,
            325 : 4.64,
            350 : 4.91,
            375 : 5.2,
            410 : 5.47,
            450 : 5.75,
            500 : 6.05,
            540 : 6.33,
        },
        420 : {
            280 : 4.25,
            300 : 4.53,
            325 : 4.82,
            350 : 5.1,
            375 : 5.41,
            410 : 5.69,
            450 : 5.98,
            500 : 6.3,
            540 : 6.6,
        },
        440 : {
            280 : 4.4,
            300 : 4.7,
            325 : 5,
            350 : 5.3,
            375 : 5.62,
            410 : 5.91,
            450 : 6.21,
            500 : 6.55,
            540 : 6.86,
        }
    }
    
    KZ_DB = {
        20 : 0.014,
        30 : 0.022,
        40 : 0.03,
        50 : 0.042,
        60 : 0.05,
        75 : 0.064,
        90 : 0.082,
        110 : 0.1,
        130 : 0.12,
        150 : 0.16,
        180 : 0.18,
        210 : 0.24,
        240 : 0.28,
        270 : 0.3,
        300 : 0.34,
        350 : 0.406666667,
        400 : 0.473333333,
    }
    
    def __init__(self, D_in, H, lotus=0):
        self.name = 'Патрубок'
        self.D_in = D_in
        self.H = H

        self.noise_koef = 1
        
        self.elements = []
        self.elements_hours = []
        
        if lotus == 1:
            self.noise_koef = 1.02            
            
        
    def calc_hours(self):
        
        self.hours = {}
        
        # 1. Подготовка места 
        self.hours[1] = ['mechanical_fastener_processing', self.MX_DB[self.D_in][self.H] + self.find_nearest_KZ() + 0.05 + 0.06 + 0.12 + 0.03]
        
        # ИТОГ
        self.total_hours = sum([i[1] for i in self.hours.values()])
        
    
    def find_nearest_KZ(self):
        for i in self.KZ_DB.keys():
            i_prev = i
            if i > self.D_in:
                return self.KZ_DB[i_prev]
        return False
                